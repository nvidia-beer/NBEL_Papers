# 2023: Autonomous Driving Controllers with Neuromorphic Spiking Neural Networks

## Paper Info

**Authors:** Raz Halaly and Elishai Ezra Tsur  
**Publication:** Frontiers in Neurorobotics, 11 August 2023  
**DOI:** 10.3389/fnbot.2023.1234962  
**Link:** [PDF](https://static1.squarespace.com/static/555995e2e4b0c9f3319aaa47/t/64d611c14f50ac4c8902fb29/1691750853375/2023+Halaly+et+al.pdf)

## Overview

This paper explores neuromorphic implementations of four path-tracking controllers for autonomous driving: **Pure-pursuit, Stanley, PID, and MPC**. The goal is to demonstrate that SNNs can perform competitively with conventional CPU-based controllers.

**Application:** Autonomous vehicle control in AirSim physics simulator on the FST Driverless race course.

### The Problem

Autonomous driving systems require significant computational and energy resources. Traditional CPU-based controllers are accurate but energy-intensive. Can neuromorphic brain-inspired control match their performance while offering energy efficiency advantages?

## Method

### Neural Engineering Framework (NEF)

> **See [Neural Engineering Framework (NEF)](NEF.md) for comprehensive mathematical foundations**

Mathematical framework for building spiking neural networks:

- **Representation:** Neurons encode/decode numerical values via spiking patterns
- **Transformation:** Neural connections approximate any function $f(x)$ using optimized decoders
- **Dynamics:** Recurrent connections implement integrators and feedback loops

**Key Equation for Encoding:**

$$
a_i(x) = G_i[\alpha_i \phi_i \cdot x(t) + J_{\text{bias}}^i]
$$

where $G_i$is the neuron model (Leaky Integrate-and-Fire),$\alpha_i$is gain,$\phi_i$is preferred stimulus, and$J_{\text{bias}}^i$ is bias current.

### Vehicle Model: Kinematic Bicycle Model (KBM)

> **See [Kinematic Bicycle Model (KBM)](KBM.md) for detailed vehicle dynamics and reference point comparisons**

Simplified 4-wheel vehicle as 2-wheel system with state $(x, y, \theta, \delta)$:

- Position: $x, y$
- Heading: $\theta$
- Steering angle: $\delta$

**Front axle reference:**

$$
x_{t+1} = x_t + v \cos(\theta_t + \delta_t) \Delta t
$$
$$
y_{t+1} = y_t + v \sin(\theta_t + \delta_t) \Delta t
$$
$$
\theta_{t+1} = \theta_t + \frac{v \sin(\delta_t)}{L} \Delta t
$$

## Controllers Tested

### A. Pure-Pursuit

> **See [Control Systems: Pure-Pursuit](Control.md#2-pure-pursuit-path-following) for geometric principles and tuning**

Geometrically chases a target point ahead on the reference trajectory.

**Steering Equation:**

$$
\delta(t) = \arctan\left(\frac{2L \sin(\alpha)}{l_d}\right)
$$

where $L$is wheelbase,$l_d$is look-ahead distance (8m), and$\alpha$ is angle to target.

**Performance:**
- Tested with 10–2,500 neurons
- Performance **converges at 100 neurons**
- Low speed (5-10 m/s): CTE 0.12–0.23m with 100 neurons
- High speed (15 m/s): CTE 2.02m with $\tau$ = 5ms
- Requires $\tau \leq 10$ms for successful completion

### B. Stanley

> **See [Control Systems: Stanley Controller](Control.md#3-stanley-lateral-controller) for error correction mechanisms**

Minimizes cross-track error (CTE) and heading error.

**Steering Equation:**

$$
\delta(t) = \psi(t) + \arctan\left(\frac{k \cdot e(t)}{k_s + v(t)}\right)
$$

where $\psi(t)$is heading error,$e(t)$is CTE,$k$and$k_s$ are gain coefficients.

**Performance:**
- Tested with 100–10,000 neurons
- Requires **more than 1,000 neurons to converge**
- At 2,500 neurons: relatively smooth driving with small zig-zag patterns
- At 10,000 neurons: smoother path but some trajectory drift
- Low speed (5 m/s, 1000 neurons): CTE 0.90m vs CPU 0.92m
- Requires $\tau < 50$ms for successful completion

### C. PID Controller

> **See [Control Systems: PID Controller](Control.md#1-proportional-integral-derivative-pid-controller) for tuning methods and applications**

Continuously corrects errors using proportional, integral, and derivative terms.

**Control Equation:**

$$
u(t) = K_p e(t) + K_i \int_0^t e(t)dt + K_d \frac{de}{dt}
$$

**Steering Error:**

$$
u(t) = e(t) + v(t) \sin(\psi(t))
$$

**Performance:**
- Tested with 10–2,500 neurons per ensemble
- **50 neurons per ensemble sufficient** for collision-free driving (5-20 m/s)
- Performance **plateaus at 100 neurons** per ensemble
- Surprisingly outperforms CPU at high speed (20 m/s) with 100 neurons
- Requires lower time constants for better performance ($\tau \leq 100$ms for all drives completed)

### D. MPC (Model Predictive Control)

> **See [Control Systems: Model Predictive Control](Control.md#4-model-predictive-control-mpc) for optimization formulation and constraint handling**

**Hybrid Design:** Neuromorphic optimizer + CPU for mathematical calculations

Optimizes future trajectory over prediction horizon using cost function:

$$
\begin{aligned}
\text{Cost} = \sum_{k=1}^{N} \bigg[ 50e^2(k) + 100\psi^2(k) + 100(v_{\text{ref}} - v(k))^2 \\
+ 100\delta^2(k) + a^2(k) + 200(\delta(k) - \delta(k-1))^2 \\
+ 10(a(k) - a(k-1))^2 \bigg]
\end{aligned}
$$

**Performance:**
- Tested with 10–2,500 neurons per ensemble
- Works well with **as few as 10 neurons** per ensemble (except at 20 m/s)
- CTE: 1.04m with $\tau$ = 10, 50, or 100ms
- Comparable to CPU performance except at highest speed (20 m/s)
- Fails to complete at $\tau \geq 300$ms

<img src="../figures/2023/image2.png" alt="SNN Controller Architectures - Pure-pursuit, Stanley, PID, and MPC" width="700"/>

*Schematic design of the controllers implemented as an SNN. (A) Pure-pursuit, (B) Stanley, (C) PID, (D) MPC.*

## Experimental Setup

**Simulator:** Microsoft AirSim (Unreal Engine-based, physics-aware)  
**Track:** FST Driverless Environment (15m width road)  
**Vehicle:** AirSim SUV model  
**Sensor:** LiDAR (180° FOV, 0.5° resolution, 40m range, 40 Hz)  
**Control Rate:** 200 Hz (5ms timestep)  
**Implementation:** Nengo library (Python) for neuromorphic, Python for CPU

<img src="../figures/2023/image1.png" alt="System Design - AirSim SUV with LiDAR in FST Driverless Environment" width="700"/>

**Test Parameters:**
- **Speeds:** 2, 5, 10, 15, 20 m/s
- **Neurons tested:** 10, 25, 50, 100, 250, 500, 1,000, 2,500 (Stanley also: 5,000, 10,000)
- **Time constants ($\tau$):** 5, 10, 50, 100, 300, 500, 700, 900, 1,100 ms
- **Trials:** 10 repetitions per configuration

## Key Findings

### Performance Summary

| Controller | Neuron Requirements | Speed Range | Key Insight |
|-----------|-------------------|-------------|-------------|
| **Pure-pursuit** | Converges at 100 neurons | Works 2-20 m/s | Simple, efficient; needs $\tau \leq 10$ms |
| **Stanley** | >1,000 neurons to converge | Works 2-20 m/s | Complex; needs $\tau < 50$ms; 2,500+ for smooth driving |
| **PID** | 50 neurons minimum, plateaus at 100 | Works 5-20 m/s | Surprisingly outperforms CPU at 20 m/s |
| **MPC** | 10 neurons works well | Works 5-15 m/s | Hybrid design; struggles at 20 m/s |

### General Observations

1. **Most models converge with 100-1,000 neurons** (Stanley is exception requiring more)
2. **Time constants are critical:** Fast synaptic responses ($\tau < 100$ms) needed, with controller-specific requirements
3. **Speed limitations:** All neuromorphic controllers degrade faster than CPU at high speeds (≥15 m/s)
4. **Hybrid designs show promise:** MPC hybrid model demonstrates advantages of combining neuromorphic and conventional computing

## Why This Matters

This paper demonstrates that neuromorphic controllers can match conventional CPU performance for autonomous vehicle path tracking:
- **Four distinct controllers** (Pure-pursuit, Stanley, PID, MPC) successfully implemented as SNNs
- **Competitive performance** with as few as 10-100 neurons depending on controller complexity
- **Energy efficiency potential** through neuromorphic hardware (though not quantified in this simulation study)
- **Hybrid approaches** combining neuromorphic and conventional computing show promise

### Key Insights

1. **Controller complexity determines neuron requirements:** Simple controllers (Pure-pursuit, PID) need 100 neurons, while complex ones (Stanley) require 1,000+
2. **Time constants are critical:** Fast synaptic responses ($\tau < 100$ms) essential for real-time control
3. **Hybrid designs work:** MPC demonstrates successful integration of neuromorphic optimization with CPU calculations
4. **High-speed challenges remain:** All neuromorphic controllers degrade faster than CPU at ≥15 m/s

### Limitations

- **High-speed degradation:** Neuromorphic implementations perform worse at ≥15 m/s compared to CPU
- **Rate-coding constraints:** Current rate-coded representation limits high-speed performance
- **Simulation only:** No real hardware or physical vehicle testing
- **Energy efficiency not quantified:** While mentioned as an advantage, specific power savings not measured

### Connection to Other Work

Builds on the **Neural Engineering Framework (NEF)** established in prior work:
- **2021 paper:** Demonstrated NEF for inverse kinematics with data-driven learning
- **2022 paper:** Applied neuromorphic control to adaptive assistive robotics
- **This work (2023):** Extends neuromorphic control to autonomous driving with multiple controller architectures
- **Future directions:** Real neuromorphic hardware testing, alternative coding schemes (time-to-spike), physical vehicle validation

This work validates that neuromorphic approaches can handle real-time control tasks across diverse algorithms, paving the way for energy-efficient autonomous systems.
